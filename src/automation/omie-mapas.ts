// ==========================================
// 1. MAPA DAS CONTAS CORRENTES (BANCOS)
// ==========================================
export const MAPA_BANCOS: Record<string, number> = {
    'BANCO DO BRASIL': 1799886099,
    'CAIXINHA': 1794424427,
    'POUPANÇA B.B': 1799887187,
    'BANCO INTER': 1799887547,
    'BANCO DO BRASIL APLICACAO': 1893198921,
    'XP INVESTIMENTOS': 2105517550,
    'OMIE.CASH': 2114507949
};

export function obterIdBanco(nome: string): number {
    const busca = String(nome || '').toUpperCase().trim();
    return MAPA_BANCOS[busca] || 1799886099;
}

// ==========================================
// 2. MAPA DE CATEGORIAS (FINANCEIRO OMIE)
// ==========================================
export const MAPA_CATEGORIAS: Record<string, string> = {
    '200220- PRESTAÇÃO DE SERVIÇOS MÉDICOS': '2.03.94',
    'PRESTAÇÃO DE SERVIÇOS MÉDICOS': '2.03.94',
    'SERVIÇOS MÉDICOS': '2.03.94',
    '200204-DISTRIBUIÇÃO DE LUCROS': '2.03.04',
    'ASSISTÊNCIA MÉDICA': '2.03.03',
    'SALÁRIO': '2.03.14',
    'ALUGUEL': '2.04.01',
    'ENERGIA ELÉTRICA': '2.04.04',
    'TELEFONIA': '2.04.05',
    '200801 - PROSPECÇÃO DE CLIENTES': '2.11.99',
    '200802-ATESTADO DE CAPACIDADE TÉCNICA': '2.11.98',
    'COMPRA DE SERVIÇOS': '2.01.04',
};

export function obterCodigoCategoria(nome: string): string {
    const busca = String(nome || '').toUpperCase().trim();
    const codigoEncontrado = MAPA_CATEGORIAS[busca];

    if (codigoEncontrado && codigoEncontrado !== 'CODIGO_AQUI') {
        return codigoEncontrado;
    }

    return '2.03.94';
}

// ==========================================
// 3. MAPA DE PROJETOS (CIDADES / CONTRATOS - COLUNA H)
// ==========================================
export const MAPA_PROJETOS: Record<string, number> = {
    'PM PINDA- ESPECIALIDADES': 1826266885,
    'SJC- CRED 02/2018': 1826267846,
    'SJC- CRED 12/2020': 1826268063,
    'PM JAMBEIRO- SAÚDE DA FAMÍLIA': 1826268720,
    'SARAPUÍ- PA': 1826269013,
    'SAP- P.A UNIDADE MISTA': 1826269967,
    'PINDA- ENDOCRINOLOGIA': 1826270483,
    'CERQUILHO': 1826270758,
    'IARAS': 1826270772,
    'PM JAMBEIRO - ESPECIALIDADES': 1893138267,
    'PM JAMBEIRO - PRONTO ATENDIMENTO': 1893138608,
    'PM JACAREÍ': 1893138960,
    'SANTECORP': 1930901832,
    'SAP - BIOMEDICINA': 1930901934,
    'PM - JAMBEIRO PRONTO ATENDIMENTO': 1935178778,
    'PINDA - ENDOCRINOLOGIA': 1935179247,
    'SJC - CRED 02/2018': 1935180120,
    'SARAPUÍ-PA': 1935192246,
    'SÃO BENTO - PLANTÃO': 1935231786,
    'OLEO -GENERALISTAS': 1952221765,
    'PARAIBUNA-SP': 1965426609,
    'ADMINISTRATIVO': 1970243926,
    'SÓCIOS': 1970244047,
    'PINDA - ADMINISTRATIVO': 1980851656,
    'VARGINHA-PLANTÃO': 1986088721,
    'PATROCINIO PAULISTA - PLANTÃO': 1994017728,
    'SARAPUÍ - MÉDICO 40 HORAS': 1994028355,
    'VITALLIS': 1994898492,
    '2001-ADMINISTRATIVO': 2003832172,
    '2002-RH-DESPESA PESSOAL': 2003832184,
    '2003-FISCAL-IMPOSTOS': 2003832190,
    '2004-FINANCEIRO-TAXAS BANCÁRIAS/DESPESAS FINANCEIRAS': 2003832200,
    '2005-PROPAGANDA E MARKETING': 2003832212,
    '2006-TI': 2003832218,
    '2007-INVESTIMENTOS': 2003832234,
    '2008-SJC-CREDENCIAMENTO 02-2018': 2003832241,
    '2009-SJC - CREDENCIAMENTO 12-2020': 2003832270,
    '2010-PINDA-ENDOCRINOLOGISTA': 2003832286,
    '2011-PINDA - SAÚDE MENTAL': 2003832300,
    '2012-CERQUILHO - ATENÇÃO BÁSICA': 2003832316,
    '2013-IARAS - ATENÇÃO BÁSICA': 2003832322,
    '2014-SAP - PLANTÃO MÉDICO': 2003832325,
    '2015-SAP-PEDIATRAS': 2003832333,
    '2016-JAMBEIRO - PLANTÃO MÉDICO': 2003832379,
    '2017-JAMBEIRO - MÉDICO PSF (FAMÍLIA)': 2003832409,
    '2018-SARAPUÍ - PLANTÃO MÉDICO': 2003832427,
    '2019-SANTECORP': 2003832454,
    '2020-JACAREÍ - PSIQUIATRA': 2003832474,
    '2021-ÓLEO-GENERALISTAS': 2003832510,
    '2022-PARAIBUNA-PEDIATRA': 2003832525,
    '2023-PATROCINIO PAULISTA-PLANTÃO MÉDICO': 2003832541,
    '2024-JAMBEIRO-ESPECIALISTAS': 2003832562,
    '2025-SÃO BENTO DO SAPUCAÍ-PLANTÃO MÉDICO': 2003832573,
    '2026-SAP-BIOMÉDICA': 2003832575,
    '2027-SARAPUÍ-MÉDICA 40 HORAS': 2003832585,
    '2028-VARGINHA-PLANTÃO MÉDICO': 2003832602,
    '2029- PINDA CAPS': 2003851316,
    '2030- SAP EDUCADOR FÍSICO': 2003861525,
    '2031- REDENÇÃO DA SERRA': 2004208326,
    '2032-SAP NEUROPEDIATRA': 2008611032,
    '2033- SAP GINECOLOGISTA': 2008612222,
    '2034- SAP PSIQUIATRA': 2008612580,
    '2035-CARDIOLOGISTA': 2011036996,
    '2036-PINDA EMAD': 2011587765,
    '2037-JACAREÍ MÉDICO DO TRABALHO': 2011588608,
    'PINDA': 2016772562,
    '2038-SÃO LUIZ DO PARAITINGA': 2017407141,
    '2039-LAGOINHA MÉDICO ESF': 2017701306,
    '2040-FERNANDOPOLIS-PLANTÕES': 2019262655,
    '2041-PARAIBUNA-ESF': 2019379782,
    '2042-ÓLEO-ESPECIALISTAS': 2022030052,
    '2043-SAP MÉDICA DO TRABALHO': 2025615091,
    '2044-PARAIBUNA-GINECOLOGIA': 2026115315,
    '2045-PARAIBUNA-PSIQUIATRA': 2026115775,
    '2046-CACHOEIRINHA-PLANTÕES': 2034843525,
    '2047-CACHOEIRINHA - UBS': 2073495507,
    '2048 - SAP ROSAP': 2093078441,
    '2049-SAP PEDIATRA': 2097312828,
    '2050-COMERCIAL': 2105469814,
    '2051-FINANCEIRO-  FINANCIAMENTO/EMPRESTIMO': 2106063014,
    '2052-IARAS-SERVIÇOS TERCEIROS': 2106078746,
    '2053-JAMBEIRO- PSICOLOGA;FONO;NUTRI;PEDIATRA': 2109225816,
    '2054-FUSAM CIRURGIA': 2115646932,
    '2055-SANTA BRANCA-PSIQUIATRA': 2115681613,
    '2056-CARAGUATATUBA-SERVIÇOS TERCEIROS': 2116363040,
    '2057-FUSAM PSA': 2122651295,
    '2058-FUSAM PROJETO DENGUE': 2122653849,
    '2002': 2141288374,
    '2060-SANTA BRANCA-UBS': 2144230567,
    '2059-SANTA BRANCA-PA': 2144230682,
    '2061-JACAREÍ-CRED. PEDIATRA': 2180739505,
    '2062-JACAREÍ CRED. CAPS': 2180739552,
    '2063-MONTEIRO LOBATO PA': 2182780979,
    '2064-MONTEIRO LOBATO UBS': 2182780981,
    '2065-SAP CARDIOLOGISTA': 2204403527,
    '2066 -  ESCRITÓRIO NOVO': 2254827148,
    'RH': 2261882879,
    '2068-TAUBATÉ PSICÓLOGOS': 2267913774,
    '2067-PIQUETE PA': 2291252922,
    '2069-PIQUETE ESPECIALIDADES': 2291271594,
    '2060': 2297645738,
    '2014': 2297675121,
    'IMPOS': 2300560247,
    '2070 - TARUMÃ PA': 2300610032,
    '2071 - CEISP SERVIÇOS EDUCACIONAIS': 2301762133,
    'F': 2303627788,
    '2040': 2305461011,
    '2061': 2305492477,
    '2011': 2306354708,
    '2054': 2308921681,
    '2072-MANDIRITUBA': 2312172722,
    '2004': 2314179292,
    '2073-CEJAM FISIATRA': 2321673521,
    '2074-SÃO BENTO SAPUCAI-PSIQUIATRA': 2341655104,
    '2075-CEJAM OTORRINO': 2341754372,
    '2076-TJ BAURU': 2354129618,
    '2077-TJ CAMPINAS': 2354129994,
    '2078- TJ RIBEIRAO PRETO': 2354135358,
    '2079- TJ SANTOS': 2354135381,
    '2080- TJ SAO JOSE DO RIO PRETO': 2354135418,
    '2081 - TJ SAO JOSE DOS CAMPOS': 2354135478,
    '2082 - TJ SOROCABA': 2354135513,
    '2083-CISMETRO-PARAIBUNA': 2362020780,
    '2084-CEJAM ORTOPEDIA': 2362056424,
    '2085-SÃO BENTO DO SAPUCAÍ-ESPECIALIDADES': 2362056440,
    '2086-SÃO JOSÉ DOS CAMPOS-CREDENCIAMENTO 01-2025': 2362056464,

    // Apelidos para correções do Excel
    '2086-S.1J.CAMPOS-CREDENCIAMENTO 01-2025': 2362056464,
    '2026-LAGOINHA-ESPECIALIDADES': 2017701306,
    '2028-MONTEIRO LOBATO-PA': 2182780979,
    '2025-SAP-CARDIOLOGISTA': 2204403527,
    '2020-SJC-CREDENCIAMETO 02/2023': 1826268063,
    'SHM - JACAREÍ CS': 1893138960,
    'SHM - SAP ESPECIALIDADES': 1930901934,
    'VITALLIS - SAP NEUROPED': 1994898492,
    'VITALLIS - SARAPUÍ PA': 1994898492
};

/**
 * Busca o ID do Projeto na Omie com "Inteligência" (Fuzzy Search):
 * Ignora espaços, traços e diferenças minúsculas/maiúsculas.
 */
export function obterIdProjeto(nome: string): number {
    if (!nome) return 0;

    const busca = String(nome).toLowerCase().replace(/[^a-z0-9]/g, '');

    for (const [key, value] of Object.entries(MAPA_PROJETOS)) {
        const keyClean = key.toLowerCase().replace(/[^a-z0-9]/g, '');

        if (busca === keyClean || keyClean.includes(busca) || busca.includes(keyClean)) {
            return value;
        }
    }

    return 0; // Retorna 0 (vazio) só se for impossível achar
}